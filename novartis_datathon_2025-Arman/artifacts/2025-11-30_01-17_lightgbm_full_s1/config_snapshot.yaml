config_hash: 989554f7
data_config:
  columns:
    calendar_month: month
    generics_cols:
    - n_gxs
    id_keys:
    - country
    - brand_name
    medicine_info_boolean:
    - biological
    - small_molecule
    medicine_info_categorical:
    - ther_area
    - main_package
    medicine_info_numerical:
    - hospital_rate
    meta_cols:
    - country
    - brand_name
    - months_postgx
    - bucket
    - avg_vol_12m
    - y_norm
    - volume
    - mean_erosion
    - month
    model_target: y_norm
    raw_target: volume
    time_key: months_postgx
  drive:
    base_path: /content/drive/MyDrive/novartis-datathon-2025
    interim_dir: /content/drive/MyDrive/novartis-datathon-2025/data/interim
    processed_dir: /content/drive/MyDrive/novartis-datathon-2025/data/processed
    raw_dir: /content/drive/MyDrive/novartis-datathon-2025/data/raw
  files:
    aux_metric: docs/guide/auxiliar_metric_computation_example.csv
    submission_example: docs/guide/submission_example.csv
    submission_template: docs/guide/submission_template.csv
    test:
      generics: TEST/df_generics_test.csv
      medicine_info: TEST/df_medicine_info_test.csv
      volume: TEST/df_volume_test.csv
    train:
      generics: TRAIN/df_generics_train.csv
      medicine_info: TRAIN/df_medicine_info_train.csv
      volume: TRAIN/df_volume_train.csv
  missing_values:
    biological:
      add_missing_flag: true
      default: false
    hospital_rate:
      add_missing_flag: true
      group_by: ther_area
      strategy: median_by_group
    main_package: Unknown
    n_gxs:
      strategy: ffill_then_zero
    small_molecule:
      add_missing_flag: true
      default: false
    ther_area: Unknown
    volume: keep
  paths:
    artifacts_dir: artifacts
    interim_dir: data/interim
    processed_dir: data/processed
    raw_dir: data/raw
  schema:
    generics:
      columns:
      - country
      - brand_name
      - months_postgx
      - n_gxs
      primary_key:
      - country
      - brand_name
      - months_postgx
    medicine_info:
      columns:
      - country
      - brand_name
      - ther_area
      - hospital_rate
      - main_package
      - biological
      - small_molecule
      primary_key:
      - country
      - brand_name
    volume:
      columns:
      - country
      - brand_name
      - month
      - months_postgx
      - volume
      primary_key:
      - country
      - brand_name
      - months_postgx
  validation:
    expected_test_series_s1: 228
    expected_test_series_s2: 112
    expected_train_series: 1953
    forecast_horizon: 24
features_config:
  drug:
    boolean:
    - biological
    - small_molecule
    categoricals:
    - ther_area
    - main_package
    derive_is_injection: true
    encoding: label
    hospital_rate_bins:
    - 30
    - 70
    numerical:
    - hospital_rate
  generics:
    include_cummax: true
    include_entry_speed: true
    include_first_month: true
    include_future_n_gxs: true
    include_has_generic: true
    include_multiple_generics: true
    include_n_gxs: true
  interactions:
    enabled: false
    pairs:
    - - n_gxs
      - biological
    - - hospital_rate
      - months_postgx
    - - ther_area_encoded
      - n_gxs
  leakage_prevention:
    forbidden_features:
    - bucket
    - y_norm
    - volume
    - mean_erosion
    - country
    - brand_name
    scenario1:
      feature_cutoff: 0
      target_range:
      - 0
      - 23
    scenario2:
      feature_cutoff: 6
      target_range:
      - 6
      - 23
  pre_entry:
    compute_max: true
    compute_min: true
    compute_seasonal: true
    compute_trend: true
    compute_volatility: true
    log_transform: true
    windows:
    - 3
    - 6
    - 12
  scenario2_early:
    compute_avg_0_5: true
    compute_drop_month_0: true
    compute_erosion_0_5: true
    compute_trend_0_5: true
  selection:
    correlation_threshold: 0.95
    drop_high_correlation: false
    drop_low_variance: false
    variance_threshold: 0.01
  target_encoding:
    enabled: false
    features:
    - ther_area
    - country
    n_folds: 5
    smoothing: 10
  time:
    decay_alpha: 0.1
    include_decay: true
    include_is_post_entry: true
    include_month_of_year: true
    include_months_postgx: true
    include_quarters: true
    include_squared: true
    include_time_bucket: true
    time_buckets:
      early:
      - 0
      - 5
      late:
      - 12
      - 23
      mid:
      - 6
      - 11
      pre:
      - -999
      - -1
model_config:
  active_config_id: null
  best_params:
    scenario1:
      learning_rate: 0.05
      min_data_in_leaf: 20
      num_leaves: 63
    scenario2:
      learning_rate: 0.05
      min_data_in_leaf: 20
      num_leaves: 31
  ensemble:
    default_weight: 0.5
    include: true
    weight_optimization: true
  gpu:
    device_id: 0
    enabled: false
    platform_id: 0
  model:
    name: lightgbm
    priority: 2
    task: regression
  params:
    bagging_fraction: 0.8
    bagging_freq: 5
    boosting_type: gbdt
    cat_smooth: 10
    early_stopping_rounds: 50
    feature_fraction: 0.8
    lambda_l1: 0.0
    lambda_l2: 0.0
    learning_rate: 0.05
    max_depth: -1
    metric: rmse
    min_data_in_leaf: 20
    min_sum_hessian_in_leaf: 0.001
    n_estimators: 3000
    n_jobs: -1
    num_leaves: 63
    objective: regression
    seed: 42
    verbose: -1
  sweep:
    enabled: false
    grid:
      learning_rate:
      - 0.02
      - 0.03
      - 0.05
      min_data_in_leaf:
      - 20
      - 40
      - 80
      num_leaves:
      - 31
      - 63
      - 127
    mode: configs
    n_folds: 3
    selection_metric: official_metric
  sweep_configs:
  - description: Default balanced configuration
    id: default
    params:
      learning_rate: 0.05
      min_data_in_leaf: 20
      num_leaves: 63
  - description: Lower learning rate for better generalization
    id: low_lr
    params:
      learning_rate: 0.02
      min_data_in_leaf: 20
      n_estimators: 5000
      num_leaves: 63
  - description: More leaves for complex patterns
    id: high_leaves
    params:
      learning_rate: 0.03
      min_data_in_leaf: 10
      num_leaves: 127
  - description: Conservative settings to reduce overfitting
    id: conservative
    params:
      bagging_fraction: 0.7
      feature_fraction: 0.7
      learning_rate: 0.03
      min_data_in_leaf: 40
      num_leaves: 31
  - description: With L1/L2 regularization
    id: regularized
    params:
      lambda_l1: 0.1
      lambda_l2: 0.1
      learning_rate: 0.05
      min_data_in_leaf: 30
      num_leaves: 63
  - description: Best configuration for Scenario 1
    id: s1_best
    params:
      learning_rate: 0.05
      min_data_in_leaf: 20
      num_leaves: 63
  - description: Best configuration for Scenario 2
    id: s2_best
    params:
      learning_rate: 0.05
      min_data_in_leaf: 20
      num_leaves: 31
  sweep_presets:
    fast:
      learning_rate:
      - 0.02
      - 0.03
      - 0.05
      num_leaves:
      - 31
      - 63
      - 127
    focused:
      learning_rate:
      - 0.03
      - 0.05
      - 0.07
      num_leaves:
      - 47
      - 63
      - 95
    full:
      learning_rate:
      - 0.02
      - 0.03
      - 0.05
      min_data_in_leaf:
      - 20
      - 40
      - 80
      num_leaves:
      - 31
      - 63
      - 127
  training:
    eval_metric: rmse
    use_early_stopping: true
    use_sample_weights: true
    verbose_eval: 100
model_type: lightgbm
run_config:
  drive:
    base_path: /content/drive/MyDrive/novartis-datathon-2025
    folder_id: 1iP8ffP5MfJ6hqig1-lQpVwzfrl9uuU03
    mount_path: /content/drive
    sync_artifacts: true
  experiment:
    description: Generic Erosion Forecasting
    name: novartis-datathon-2025
  experiment_tracking:
    backend: mlflow
    enabled: false
    experiment_name: novartis-datathon-2025
    project_name: novartis-datathon-2025
    tracking_uri: null
  hardware:
    num_workers: 4
    use_gpu: false
  logging:
    console: true
    file: true
    format: '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
    level: INFO
    log_to_file: true
  metrics:
    log_dir_pattern: artifacts/{run_id}/metrics
    log_per_series: true
    names:
      mae: mae_y_norm
      mape: mape_y_norm
      rmse: rmse_y_norm
      scenario1: metric1_official
      scenario2: metric2_official
    primary: metric1_official
    secondary:
    - rmse_y_norm
    - mae_y_norm
    - mape_y_norm
  official_metric:
    bucket_threshold: 0.25
    bucket_weights:
      bucket1: 2.0
      bucket2: 1.0
    metric1:
      accumulated_0_5_weight: 0.5
      accumulated_12_23_weight: 0.1
      accumulated_6_11_weight: 0.2
      early_range:
      - 0
      - 5
      late_range:
      - 12
      - 23
      mid_range:
      - 6
      - 11
      monthly_range:
      - 0
      - 23
      monthly_weight: 0.2
    metric2:
      accumulated_12_23_weight: 0.3
      accumulated_6_11_weight: 0.5
      early_range:
      - 6
      - 11
      late_range:
      - 12
      - 23
      monthly_range:
      - 6
      - 23
      monthly_weight: 0.2
  output:
    save_config_snapshot: true
    save_feature_importance: true
    save_oof_predictions: true
    save_test_predictions: true
    save_training_curves: true
  paths:
    artifacts_dir: artifacts
    logs_dir: artifacts/logs
    metrics_dir: artifacts/metrics
    submissions_dir: submissions
  reproducibility:
    deterministic: true
    seed: 42
  run:
    name_format: '{timestamp}_{model}_{scenario}'
    timestamp_format: '%Y-%m-%d_%H-%M'
  sample_weights:
    bucket_weights:
      bucket1: 2.0
      bucket2: 1.0
    scenario1:
      months_0_5: 3.0
      months_12_23: 1.0
      months_6_11: 1.5
    scenario2:
      months_12_23: 1.0
      months_6_11: 2.5
  scenarios:
    scenario1:
      feature_cutoff: 0
      forecast_end: 23
      forecast_start: 0
      name: Scenario 1 - No Post-Entry Actuals
      target_months:
      - 0
      - 1
      - 2
      - 3
      - 4
      - 5
      - 6
      - 7
      - 8
      - 9
      - 10
      - 11
      - 12
      - 13
      - 14
      - 15
      - 16
      - 17
      - 18
      - 19
      - 20
      - 21
      - 22
      - 23
    scenario2:
      feature_cutoff: 6
      forecast_end: 23
      forecast_start: 6
      name: Scenario 2 - First 6 Months Available
      target_months:
      - 6
      - 7
      - 8
      - 9
      - 10
      - 11
      - 12
      - 13
      - 14
      - 15
      - 16
      - 17
      - 18
      - 19
      - 20
      - 21
      - 22
      - 23
  validation:
    split_level: series
    stratify_by: bucket
    val_fraction: 0.2
scenario: 1

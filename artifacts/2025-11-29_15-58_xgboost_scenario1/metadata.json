{
  "timestamp": "2025-11-29T15:58:05.876261",
  "git_commit": "8f9d8ffa",
  "scenario": 1,
  "model_type": "xgboost",
  "random_seed": 42,
  "dataset": {
    "total_rows": 93744,
    "total_series": 1953,
    "train_rows": 37488,
    "train_series": 1562,
    "val_rows": 9384,
    "val_series": 391
  },
  "validation": {
    "val_fraction": 0.2,
    "stratify_by": "bucket",
    "split_level": "series"
  },
  "configs": {
    "run_config": {
      "reproducibility": {
        "seed": 42,
        "deterministic": true
      },
      "validation": {
        "val_fraction": 0.2,
        "stratify_by": "bucket",
        "split_level": "series"
      },
      "scenarios": {
        "scenario1": {
          "name": "Scenario 1 - No Post-Entry Actuals",
          "forecast_start": 0,
          "forecast_end": 23,
          "feature_cutoff": 0,
          "target_months": [
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23
          ]
        },
        "scenario2": {
          "name": "Scenario 2 - First 6 Months Available",
          "forecast_start": 6,
          "forecast_end": 23,
          "feature_cutoff": 6,
          "target_months": [
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23
          ]
        }
      },
      "official_metric": {
        "bucket_threshold": 0.25,
        "bucket_weights": {
          "bucket1": 2.0,
          "bucket2": 1.0
        },
        "metric1": {
          "monthly_weight": 0.2,
          "accumulated_0_5_weight": 0.5,
          "accumulated_6_11_weight": 0.2,
          "accumulated_12_23_weight": 0.1,
          "monthly_range": [
            0,
            23
          ],
          "early_range": [
            0,
            5
          ],
          "mid_range": [
            6,
            11
          ],
          "late_range": [
            12,
            23
          ]
        },
        "metric2": {
          "monthly_weight": 0.2,
          "accumulated_6_11_weight": 0.5,
          "accumulated_12_23_weight": 0.3,
          "monthly_range": [
            6,
            23
          ],
          "early_range": [
            6,
            11
          ],
          "late_range": [
            12,
            23
          ]
        }
      },
      "sample_weights": {
        "scenario1": {
          "months_0_5": 3.0,
          "months_6_11": 1.5,
          "months_12_23": 1.0
        },
        "scenario2": {
          "months_6_11": 2.5,
          "months_12_23": 1.0
        },
        "bucket_weights": {
          "bucket1": 2.0,
          "bucket2": 1.0
        }
      },
      "paths": {
        "artifacts_dir": "artifacts",
        "submissions_dir": "submissions",
        "logs_dir": "artifacts/logs",
        "metrics_dir": "artifacts/metrics"
      },
      "output": {
        "save_oof_predictions": true,
        "save_test_predictions": true,
        "save_feature_importance": true,
        "save_training_curves": true,
        "save_config_snapshot": true
      },
      "metrics": {
        "primary": "metric1_official",
        "secondary": [
          "rmse_y_norm",
          "mae_y_norm",
          "mape_y_norm"
        ],
        "log_per_series": true,
        "log_dir_pattern": "artifacts/{run_id}/metrics",
        "names": {
          "scenario1": "metric1_official",
          "scenario2": "metric2_official",
          "rmse": "rmse_y_norm",
          "mae": "mae_y_norm",
          "mape": "mape_y_norm"
        }
      },
      "logging": {
        "level": "INFO",
        "console": true,
        "file": true,
        "log_to_file": true,
        "format": "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
      },
      "drive": {
        "folder_id": "1iP8ffP5MfJ6hqig1-lQpVwzfrl9uuU03",
        "mount_path": "/content/drive",
        "base_path": "/content/drive/MyDrive/novartis-datathon-2025",
        "sync_artifacts": true
      },
      "hardware": {
        "use_gpu": false,
        "num_workers": 4
      },
      "experiment": {
        "name": "novartis-datathon-2025",
        "description": "Generic Erosion Forecasting"
      },
      "experiment_tracking": {
        "enabled": false,
        "backend": "mlflow",
        "experiment_name": "novartis-datathon-2025",
        "tracking_uri": null,
        "project_name": "novartis-datathon-2025"
      },
      "run": {
        "name_format": "{timestamp}_{model}_{scenario}",
        "timestamp_format": "%Y-%m-%d_%H-%M"
      }
    },
    "data_config": {
      "paths": {
        "raw_dir": "data/raw",
        "interim_dir": "data/interim",
        "processed_dir": "data/processed",
        "artifacts_dir": "artifacts"
      },
      "files": {
        "train": {
          "volume": "TRAIN/df_volume_train.csv",
          "generics": "TRAIN/df_generics_train.csv",
          "medicine_info": "TRAIN/df_medicine_info_train.csv"
        },
        "test": {
          "volume": "TEST/df_volume_test.csv",
          "generics": "TEST/df_generics_test.csv",
          "medicine_info": "TEST/df_medicine_info_test.csv"
        },
        "aux_metric": "docs/guide/auxiliar_metric_computation_example.csv",
        "submission_template": "docs/guide/submission_template.csv",
        "submission_example": "docs/guide/submission_example.csv"
      },
      "columns": {
        "id_keys": [
          "country",
          "brand_name"
        ],
        "time_key": "months_postgx",
        "calendar_month": "month",
        "raw_target": "volume",
        "model_target": "y_norm",
        "meta_cols": [
          "country",
          "brand_name",
          "months_postgx",
          "bucket",
          "avg_vol_12m",
          "y_norm",
          "volume",
          "mean_erosion",
          "month"
        ],
        "generics_cols": [
          "n_gxs"
        ],
        "medicine_info_categorical": [
          "ther_area",
          "main_package"
        ],
        "medicine_info_numerical": [
          "hospital_rate"
        ],
        "medicine_info_boolean": [
          "biological",
          "small_molecule"
        ]
      },
      "schema": {
        "volume": {
          "primary_key": [
            "country",
            "brand_name",
            "months_postgx"
          ],
          "columns": [
            "country",
            "brand_name",
            "month",
            "months_postgx",
            "volume"
          ]
        },
        "generics": {
          "primary_key": [
            "country",
            "brand_name",
            "months_postgx"
          ],
          "columns": [
            "country",
            "brand_name",
            "months_postgx",
            "n_gxs"
          ]
        },
        "medicine_info": {
          "primary_key": [
            "country",
            "brand_name"
          ],
          "columns": [
            "country",
            "brand_name",
            "ther_area",
            "hospital_rate",
            "main_package",
            "biological",
            "small_molecule"
          ]
        }
      },
      "missing_values": {
        "volume": "keep",
        "n_gxs": {
          "strategy": "ffill_then_zero"
        },
        "hospital_rate": {
          "strategy": "median_by_group",
          "group_by": "ther_area",
          "add_missing_flag": true
        },
        "ther_area": "Unknown",
        "main_package": "Unknown",
        "biological": {
          "default": false,
          "add_missing_flag": true
        },
        "small_molecule": {
          "default": false,
          "add_missing_flag": true
        }
      },
      "drive": {
        "base_path": "/content/drive/MyDrive/novartis-datathon-2025",
        "raw_dir": "/content/drive/MyDrive/novartis-datathon-2025/data/raw",
        "interim_dir": "/content/drive/MyDrive/novartis-datathon-2025/data/interim",
        "processed_dir": "/content/drive/MyDrive/novartis-datathon-2025/data/processed"
      },
      "validation": {
        "expected_train_series": 1953,
        "expected_test_series_s1": 228,
        "expected_test_series_s2": 112,
        "forecast_horizon": 24
      }
    },
    "model_config": {
      "model": {
        "name": "xgboost",
        "task": "regression",
        "priority": 1
      },
      "active_config_id": null,
      "gpu": {
        "enabled": false,
        "device_id": 0
      },
      "sweep": {
        "enabled": false,
        "mode": "configs",
        "selection_metric": "official_metric",
        "n_folds": 3,
        "grid": {
          "max_depth": [
            3,
            4,
            5,
            6
          ],
          "learning_rate": [
            0.02,
            0.03,
            0.05,
            0.07
          ],
          "reg_lambda": [
            1,
            3,
            5
          ]
        }
      },
      "sweep_configs": [
        {
          "id": "default",
          "description": "Default balanced configuration",
          "params": {
            "max_depth": 6,
            "learning_rate": 0.03,
            "reg_lambda": 1
          }
        },
        {
          "id": "low_lr",
          "description": "Lower learning rate for more trees, better generalization",
          "params": {
            "max_depth": 6,
            "learning_rate": 0.02,
            "n_estimators": 5000,
            "reg_lambda": 1
          }
        },
        {
          "id": "shallow",
          "description": "Shallow trees to reduce overfitting",
          "params": {
            "max_depth": 4,
            "learning_rate": 0.05,
            "reg_lambda": 3
          }
        },
        {
          "id": "deep",
          "description": "Deeper trees for complex patterns",
          "params": {
            "max_depth": 8,
            "learning_rate": 0.02,
            "reg_lambda": 5,
            "min_child_weight": 3
          }
        },
        {
          "id": "regularized",
          "description": "Strong regularization",
          "params": {
            "max_depth": 5,
            "learning_rate": 0.03,
            "reg_lambda": 10,
            "reg_alpha": 1,
            "subsample": 0.7,
            "colsample_bytree": 0.7
          }
        },
        {
          "id": "s1_best",
          "description": "Best configuration for Scenario 1",
          "params": {
            "max_depth": 6,
            "learning_rate": 0.03,
            "reg_lambda": 1
          }
        },
        {
          "id": "s2_best",
          "description": "Best configuration for Scenario 2",
          "params": {
            "max_depth": 4,
            "learning_rate": 0.05,
            "reg_lambda": 1
          }
        }
      ],
      "params": {
        "booster": "gbtree",
        "objective": "reg:squarederror",
        "eval_metric": "rmse",
        "max_depth": 6,
        "min_child_weight": 1,
        "max_leaves": 0,
        "learning_rate": 0.03,
        "n_estimators": 3000,
        "gamma": 0,
        "reg_alpha": 0,
        "reg_lambda": 1,
        "subsample": 0.8,
        "colsample_bytree": 0.8,
        "colsample_bylevel": 1.0,
        "colsample_bynode": 1.0,
        "early_stopping_rounds": 50,
        "verbosity": 0,
        "n_jobs": -1,
        "seed": 42
      },
      "training": {
        "use_early_stopping": true,
        "eval_metric": "rmse",
        "verbose_eval": 100,
        "use_sample_weights": true
      },
      "best_params": {
        "scenario1": {
          "max_depth": 6,
          "learning_rate": 0.03,
          "reg_lambda": 1
        },
        "scenario2": {
          "max_depth": 4,
          "learning_rate": 0.05,
          "reg_lambda": 1
        }
      },
      "sweep_presets": {
        "fast": {
          "max_depth": [
            4,
            5,
            6,
            7
          ],
          "learning_rate": [
            0.02,
            0.03,
            0.05,
            0.07
          ]
        },
        "full": {
          "max_depth": [
            3,
            4,
            5,
            6
          ],
          "learning_rate": [
            0.02,
            0.03,
            0.05,
            0.07
          ],
          "reg_lambda": [
            1,
            3,
            5
          ]
        },
        "focused": {
          "max_depth": [
            5,
            6,
            7
          ],
          "learning_rate": [
            0.02,
            0.03,
            0.04
          ]
        }
      },
      "ensemble": {
        "include": true,
        "weight_optimization": true,
        "default_weight": 0.5
      }
    }
  },
  "config_hash": "1b905dc2"
}
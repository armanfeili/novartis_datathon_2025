# Run configuration with ALL Bonus Features Enabled
# This config enables all implemented bonus experiments for maximum performance

# Reproducibility
reproducibility:
  seed: 42
  deterministic: true

# Validation configuration
validation:
  val_fraction: 0.2
  stratify_by: "bucket"
  split_level: "series"

# Scenario definitions
scenarios:
  scenario1:
    name: "Scenario 1 - No Post-Entry Actuals"
    forecast_start: 0
    forecast_end: 23
    feature_cutoff: 0
    target_months: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
    
  scenario2:
    name: "Scenario 2 - First 6 Months Available"
    forecast_start: 6
    forecast_end: 23
    feature_cutoff: 6
    target_months: [6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]

# Official competition metric weights
official_metric:
  bucket_threshold: 0.25
  bucket_weights:
    bucket1: 2.0
    bucket2: 1.0
  metric1:
    monthly_weight: 0.2
    accumulated_0_5_weight: 0.5
    accumulated_6_11_weight: 0.2
    accumulated_12_23_weight: 0.1
    monthly_range: [0, 23]
  metric2:
    monthly_weight: 0.2
    accumulated_6_11_weight: 0.5
    accumulated_12_17_weight: 0.2
    accumulated_18_23_weight: 0.1
    monthly_range: [6, 23]

# Paths
paths:
  artifacts_dir: "artifacts"
  submissions_dir: "submissions"
  logs_dir: "logs"

# Experiment tracking
tracking:
  enabled: true
  log_level: "INFO"

# =============================================================================
# BONUS EXPERIMENTS - ALL ENABLED
# =============================================================================

# B2: Bucket Specialization
bucket_specialization:
  enabled: true                      # ✅ ENABLED
  buckets: [1, 2]
  base_model_type: "catboost"

# B3: Post-hoc Calibration
calibration:
  enabled: true                      # ✅ ENABLED
  grouping: ["scenario", "bucket", "time_window"]
  method: "linear"                   # "linear" or "isotonic"
  time_windows_s1: [[0, 5], [6, 11], [12, 23]]
  time_windows_s2: [[6, 11], [12, 17], [18, 23]]

# B4: Temporal Smoothing
smoothing:
  enabled: true                      # ✅ ENABLED
  method: "rolling_median"
  window: 3
  min_periods: 1
  clip_negative: true

# B5: Residual Model
residual_model:
  enabled: false                     # ⚠️ Disabled - requires feature reconstruction
  target_buckets: [1]
  target_windows_s1: [[0, 5], [6, 11]]
  target_windows_s2: [[6, 11]]
  model_type: "catboost"

# B6: Bias Correction
bias_correction:
  enabled: true                      # ✅ ENABLED
  group_cols: ["ther_area", "country"]
  method: "mean_error"
  min_samples_per_group: 5

# B8: Multi-Seed Experiments
multi_seed:
  enabled: true                      # ✅ ENABLED
  seeds: [42, 2025, 1337]
  ensemble: false                    # Use best seed instead of ensemble
  selection_metric: "official_metric"

# B10: Target Transform
target_transform:
  type: "log1p"                      # ✅ ENABLED - log1p transform
  power_exponent: 0.5
  epsilon: 1e-6

# G6: Data Augmentation
augmentation:
  enabled: true                      # ✅ ENABLED
  jitter_volume_pct: 0.05
  drop_random_month_prob: 0.05
  min_months_postgx: 0
  max_months_postgx: 23

# G4: Small Data Mode (conservative regularization)
small_data_mode:
  enabled: false                     # Keep default for now
  overrides:
    depth: 6
    l2_leaf_reg: 6.0
    subsample: 0.8
    rsm: 0.8
    min_data_in_leaf: 20

# G5: Robust Validation
cv:
  enabled: false                     # Use single train/val split for speed
  n_folds: 5
  n_repeats: 3
  level: "series"
  stability_check: true
  stability_threshold: 0.05


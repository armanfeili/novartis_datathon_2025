2025-11-30 10:19:35 - __main__ - INFO - Logging to: logs/full_pipeline_catboost_bonus_all_20251130_101935.log
2025-11-30 10:19:35 - __main__ - INFO - ================================================================================
2025-11-30 10:19:35 - __main__ - INFO - CatBoost Hero Model Training with ALL Bonus Features
2025-11-30 10:19:35 - __main__ - INFO - ================================================================================
2025-11-30 10:19:35 - __main__ - INFO - Run Name: catboost_bonus_all_20251130_101935
2025-11-30 10:19:35 - __main__ - INFO - Config: configs/run_bonus_all.yaml
2025-11-30 10:19:35 - __main__ - INFO - Timestamp: 20251130_101935
2025-11-30 10:19:35 - __main__ - INFO - ================================================================================
2025-11-30 10:19:35 - __main__ - INFO - ✅ Config loaded successfully
2025-11-30 10:19:35 - __main__ - INFO - Config summary saved to: logs/config_summary_catboost_bonus_all_20251130_101935.yaml
2025-11-30 10:19:35 - __main__ - INFO - 
================================================================================
2025-11-30 10:19:35 - __main__ - INFO - [1/3] Training Scenario 1
2025-11-30 10:19:35 - __main__ - INFO - ================================================================================
2025-11-30 10:19:35 - __main__ - INFO - ================================================================================
2025-11-30 10:19:35 - __main__ - INFO - Training Scenario 1
2025-11-30 10:19:35 - __main__ - INFO - ================================================================================
2025-11-30 10:19:35 - __main__ - INFO - Config: configs/run_bonus_all.yaml
2025-11-30 10:19:35 - __main__ - INFO - Run Name: catboost_bonus_all_20251130_101935
2025-11-30 10:19:35 - src.utils - INFO - [Scenario 1 Training] starting...
2025-11-30 10:19:35,706 - src.train - INFO - Starting experiment: catboost_bonus_all_20251130_101935_s1
2025-11-30 10:19:35,762 - src.train - INFO - Config snapshot saved to /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s1/configs (hash: bcc22caf)
2025-11-30 10:19:35,762 - src.train - INFO - Config hash: bcc22caf
2025-11-30 10:19:35,786 - src.utils - INFO - [Load features (cached)] starting...
2025-11-30 10:19:35,786 - src.features - INFO - Building features for train S1 train...
2025-11-30 10:19:35,787 - src.data - INFO - Building train panel from raw data...
2025-11-30 10:19:35,787 - src.utils - INFO - [Load train data] starting...
2025-11-30 10:19:35,787 - src.data - INFO - Loading volume from /Users/armanfeili/code/New Projects/novartis_datathon_2025/data/raw/TRAIN/df_volume_train.csv
2025-11-30 10:19:35,872 - src.data - INFO - === train/volume Statistics ===
2025-11-30 10:19:35,873 - src.data - INFO -   Shape: 93,744 rows × 5 columns
2025-11-30 10:19:35,886 - src.data - INFO -   No missing values
2025-11-30 10:19:35,909 - src.data - INFO -   Unique series: 1,953
2025-11-30 10:19:35,910 - src.data - INFO -   months_postgx range: [-24, 23]
2025-11-30 10:19:35,913 - src.data - INFO - Loading generics from /Users/armanfeili/code/New Projects/novartis_datathon_2025/data/raw/TRAIN/df_generics_train.csv
2025-11-30 10:19:35,953 - src.data - INFO - === train/generics Statistics ===
2025-11-30 10:19:35,953 - src.data - INFO -   Shape: 46,872 rows × 4 columns
2025-11-30 10:19:35,959 - src.data - INFO -   Missing values:
2025-11-30 10:19:35,960 - src.data - INFO -     n_gxs: 26.3%
2025-11-30 10:19:35,972 - src.data - INFO -   Unique series: 1,953
2025-11-30 10:19:35,973 - src.data - INFO -   months_postgx range: [0, 23]
2025-11-30 10:19:35,974 - src.data - INFO - Loading medicine_info from /Users/armanfeili/code/New Projects/novartis_datathon_2025/data/raw/TRAIN/df_medicine_info_train.csv
2025-11-30 10:19:35,979 - src.data - INFO - === train/medicine_info Statistics ===
2025-11-30 10:19:35,979 - src.data - INFO -   Shape: 1,953 rows × 7 columns
2025-11-30 10:19:35,982 - src.data - INFO -   Missing values:
2025-11-30 10:19:35,982 - src.data - INFO -     hospital_rate: 3.3%
2025-11-30 10:19:35,984 - src.data - INFO -   Unique series: 1,953
2025-11-30 10:19:35,985 - src.utils - INFO - [Load train data] done in 0.198s
2025-11-30 10:19:35,985 - src.utils - INFO - [Build base panel] starting...
2025-11-30 10:19:35,985 - src.data - INFO - Input shapes: volume=(93744, 5), generics=(46872, 4), medicine_info=(1953, 7)
2025-11-30 10:19:36,044 - src.data - INFO - After volume-generics merge: 93,744 rows
2025-11-30 10:19:36,094 - src.data - INFO - After medicine_info merge: 93,744 rows
2025-11-30 10:19:36,169 - src.data - INFO - === Base Panel Statistics ===
2025-11-30 10:19:36,169 - src.data - INFO -   Shape: 93,744 rows × 11 columns
2025-11-30 10:19:36,192 - src.data - INFO -   Missing values:
2025-11-30 10:19:36,192 - src.data - INFO -     n_gxs: 63.2%
2025-11-30 10:19:36,192 - src.data - INFO -     hospital_rate: 3.3%
2025-11-30 10:19:36,213 - src.data - INFO -   Unique series: 1,953
2025-11-30 10:19:36,214 - src.data - INFO -   months_postgx range: [-24, 23]
2025-11-30 10:19:36,216 - src.utils - INFO - [Build base panel] done in 0.231s
2025-11-30 10:19:36,217 - src.utils - INFO - [Handle missing values] starting...
2025-11-30 10:19:36,236 - src.data - INFO - n_gxs: filled 59208 missing values
2025-11-30 10:19:36,251 - src.data - INFO - hospital_rate: filled with ther_area medians, flag added
2025-11-30 10:19:36,302 - src.data - INFO - No missing values remaining
2025-11-30 10:19:36,302 - src.utils - INFO - [Handle missing values] done in 0.085s
2025-11-30 10:19:36,306 - src.utils - INFO - [Compute pre-entry stats] starting...
2025-11-30 10:19:36,411 - src.data - INFO - avg_vol_12m distribution:
2025-11-30 10:19:36,413 - src.data - INFO -   Range: [37.72, 371038791.09]
2025-11-30 10:19:36,417 - src.data - INFO -   Median: 131382.32
2025-11-30 10:19:36,418 - src.data - INFO -   Mean: 2439028.31
2025-11-30 10:19:36,453 - src.data - INFO - Bucket classification using threshold=0.25
2025-11-30 10:19:36,518 - src.data - INFO - Bucket distribution (train):
2025-11-30 10:19:36,518 - src.data - INFO -   Bucket 1: 130 series (6.7%)
2025-11-30 10:19:36,518 - src.data - INFO -   Bucket 2: 1,823 series (93.3%)
2025-11-30 10:19:36,518 - src.data - INFO - y_norm distribution (train):
2025-11-30 10:19:36,519 - src.data - INFO -   Range: [0.000, 43.792]
2025-11-30 10:19:36,522 - src.data - INFO -   Median: 0.871
2025-11-30 10:19:36,522 - src.data - INFO -   Mean: 0.800
2025-11-30 10:19:36,525 - src.data - WARNING - y_norm.y_norm: 18 values above 5
2025-11-30 10:19:36,525 - src.utils - INFO - [Compute pre-entry stats] done in 0.219s
2025-11-30 10:19:36,544 - src.data - INFO - Panel schema validation passed for train (93,744 rows)
2025-11-30 10:19:36,547 - src.features - INFO - Applying data augmentation to training panel
2025-11-30 10:19:41,447 - src.data - INFO - Augmentation applied: jitter=5.00%, drop_prob=5.00%
2025-11-30 10:19:41,469 - src.utils - INFO - [Feature engineering - Scenario 1] starting...
2025-11-30 10:19:41,609 - src.features - WARNING - No pre-entry data for seasonal features, skipping
2025-11-30 10:19:42,306 - src.features - INFO - Total features created: 79
2025-11-30 10:19:42,306 - src.utils - INFO - [Feature engineering - Scenario 1] done in 0.838s
2025-11-30 10:19:42,400 - src.features - INFO - Selected 44,499 rows for 1 (months 0-23)
2025-11-30 10:19:42,408 - src.features - WARNING - Feature leakage detected: LEAKAGE: Forbidden column present: mean_erosion
2025-11-30 10:19:42,408 - src.features - WARNING - Feature leakage detected: LEAKAGE: Forbidden column present: y_norm
2025-11-30 10:19:42,408 - src.features - WARNING - Feature leakage detected: LEAKAGE: Forbidden column present: brand_name
2025-11-30 10:19:42,408 - src.features - WARNING - Feature leakage detected: LEAKAGE: Forbidden column present: bucket
2025-11-30 10:19:42,408 - src.features - WARNING - Feature leakage detected: LEAKAGE: Forbidden column present: volume
2025-11-30 10:19:42,408 - src.features - WARNING - Feature leakage detected: LEAKAGE: Forbidden column present: country
2025-11-30 10:19:42,457 - src.data - INFO - Data leakage audit passed for scenario 1, mode train
2025-11-30 10:19:42,467 - src.features - ERROR - Feature matrix validation failed: Feature matrix has all-NaN columns: ['first_generic_month']...
2025-11-30 10:19:42,467 - src.features - INFO - Built features: X=(44499, 76), y=44499, meta=(44499, 9)
2025-11-30 10:19:42,495 - src.utils - INFO - [Load cached train panel] starting...
2025-11-30 10:19:42,496 - src.data - INFO - Loading cached panel from /Users/armanfeili/code/New Projects/novartis_datathon_2025/data/interim/panel_train.parquet
2025-11-30 10:19:42,584 - src.data - INFO - Loaded 93,744 rows, 19 columns
2025-11-30 10:19:42,584 - src.utils - INFO - [Load cached train panel] done in 0.089s
2025-11-30 10:19:42,584 - src.utils - INFO - [Load features (cached)] done in 6.798s
2025-11-30 10:19:42,584 - src.utils - INFO - [Create validation split] starting...
2025-11-30 10:19:42,601 - src.validation - WARNING - Grouping 1 rare stratification classes (< 195 series each, 130 series total) into 'OTHER'
2025-11-30 10:19:42,604 - src.validation - INFO - 'OTHER' class now contains 130 series
2025-11-30 10:19:42,744 - src.validation - INFO - Train series: 1562, Val series: 391
2025-11-30 10:19:42,744 - src.validation - INFO - Train rows: 35,636, Val rows: 8,863
2025-11-30 10:19:42,745 - src.validation - INFO - Train bucket distribution:
bucket
2    0.933419
1    0.066581
2025-11-30 10:19:42,746 - src.validation - INFO - Val bucket distribution:
bucket
2    0.933504
1    0.066496
2025-11-30 10:19:42,777 - src.utils - INFO - [Create validation split] done in 0.192s
2025-11-30 10:19:42,822 - src.train - INFO - Features: 75 columns
2025-11-30 10:19:42,823 - src.train - INFO - Meta: 9 columns: ['country', 'brand_name', 'months_postgx', 'bucket', 'avg_vol_12m', 'y_norm', 'volume', 'mean_erosion', 'month']
2025-11-30 10:19:42,833 - src.train - INFO - Features: 75 columns
2025-11-30 10:19:42,834 - src.train - INFO - Meta: 9 columns: ['country', 'brand_name', 'months_postgx', 'bucket', 'avg_vol_12m', 'y_norm', 'volume', 'mean_erosion', 'month']
2025-11-30 10:19:42,884 - src.train - INFO - Multi-seed experiment enabled
2025-11-30 10:19:42,885 - src.train - INFO - Training with seed 42...
2025-11-30 10:19:42,892 - src.train - INFO - Applied target transform: log1p
2025-11-30 10:19:43,833 - src.train - INFO - Sample weights - min: 0.58, max: 3.46, mean: 1.00
2025-11-30 10:19:43,854 - src.utils - INFO - [Train catboost for scenario 1] starting...
2025-11-30 10:19:43,858 - src.models.cat_model - INFO - Auto-detected 2 categorical features
2025-11-30 10:19:53,663 - src.models.cat_model - INFO - CatBoost trained for 571 iterations
2025-11-30 10:19:53,663 - src.utils - INFO - [Train catboost for scenario 1] done in 9.809s
2025-11-30 10:19:54,936 - src.train - INFO - Validation metrics: Official=0.7007, RMSE=0.1943, MAE=0.1523
2025-11-30 10:19:54,936 - src.train - INFO - Training time: 9.83 seconds
2025-11-30 10:19:54,948 - src.models.cat_model - INFO - Model saved to /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s1/seed_42/model.bin.cbm with metadata
2025-11-30 10:19:54,949 - src.train - INFO - Seed 42: Official=0.7007
2025-11-30 10:19:54,949 - src.train - INFO - Training with seed 2025...
2025-11-30 10:19:54,951 - src.train - INFO - Applied target transform: log1p
2025-11-30 10:19:54,966 - src.train - INFO - Sample weights - min: 0.58, max: 3.46, mean: 1.00
2025-11-30 10:19:54,990 - src.utils - INFO - [Train catboost for scenario 1] starting...
2025-11-30 10:19:54,994 - src.models.cat_model - INFO - Auto-detected 2 categorical features
2025-11-30 10:20:02,173 - src.models.cat_model - INFO - CatBoost trained for 247 iterations
2025-11-30 10:20:02,173 - src.utils - INFO - [Train catboost for scenario 1] done in 7.183s
2025-11-30 10:20:03,341 - src.train - INFO - Validation metrics: Official=0.7354, RMSE=0.1881, MAE=0.1466
2025-11-30 10:20:03,342 - src.train - INFO - Training time: 7.21 seconds
2025-11-30 10:20:03,348 - src.models.cat_model - INFO - Model saved to /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s1/seed_2025/model.bin.cbm with metadata
2025-11-30 10:20:03,348 - src.train - INFO - Seed 2025: Official=0.7354
2025-11-30 10:20:03,348 - src.train - INFO - Training with seed 1337...
2025-11-30 10:20:03,351 - src.train - INFO - Applied target transform: log1p
2025-11-30 10:20:03,361 - src.train - INFO - Sample weights - min: 0.58, max: 3.46, mean: 1.00
2025-11-30 10:20:03,381 - src.utils - INFO - [Train catboost for scenario 1] starting...
2025-11-30 10:20:03,386 - src.models.cat_model - INFO - Auto-detected 2 categorical features
2025-11-30 10:20:12,263 - src.models.cat_model - INFO - CatBoost trained for 501 iterations
2025-11-30 10:20:12,264 - src.utils - INFO - [Train catboost for scenario 1] done in 8.882s
2025-11-30 10:20:13,573 - src.train - INFO - Validation metrics: Official=0.7106, RMSE=0.1982, MAE=0.1558
2025-11-30 10:20:13,573 - src.train - INFO - Training time: 8.90 seconds
2025-11-30 10:20:13,579 - src.models.cat_model - INFO - Model saved to /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s1/seed_1337/model.bin.cbm with metadata
2025-11-30 10:20:13,579 - src.train - INFO - Seed 1337: Official=0.7106
2025-11-30 10:20:13,582 - src.train - INFO - Saved multi-seed summary to /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s1/multi_seed_summary.csv
2025-11-30 10:20:13,583 - src.train - INFO - Multi-seed results:
2025-11-30 10:20:13,583 - src.train - INFO -   Mean official metric: 0.7156
2025-11-30 10:20:13,583 - src.train - INFO -   Std official metric: 0.0179
2025-11-30 10:20:13,584 - src.train - INFO -   Best seed: 42
2025-11-30 10:20:13,584 - src.train - INFO - Best seed: 42
2025-11-30 10:20:13,587 - src.train - INFO - Applied target transform: log1p
2025-11-30 10:20:13,596 - src.train - INFO - Sample weights - min: 0.58, max: 3.46, mean: 1.00
2025-11-30 10:20:13,614 - src.utils - INFO - [Train catboost for scenario 1] starting...
2025-11-30 10:20:13,617 - src.models.cat_model - INFO - Auto-detected 2 categorical features
2025-11-30 10:20:24,030 - src.models.cat_model - INFO - CatBoost trained for 571 iterations
2025-11-30 10:20:24,030 - src.utils - INFO - [Train catboost for scenario 1] done in 10.416s
2025-11-30 10:20:25,201 - src.train - INFO - Validation metrics: Official=0.7007, RMSE=0.1943, MAE=0.1523
2025-11-30 10:20:25,202 - src.train - INFO - Training time: 10.43 seconds
2025-11-30 10:20:25,205 - src.train - INFO - Fitting calibration parameters
2025-11-30 10:20:25,257 - src.train - INFO - Saved calibration parameters to /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s1/calibration_params.json
2025-11-30 10:20:25,259 - src.train - INFO - Calibration parameters fitted for 6 groups
2025-11-30 10:20:25,259 - src.train - INFO - Fitting bias corrections
2025-11-30 10:20:25,298 - src.train - INFO - Merged group columns from panel: ['ther_area']
/Users/armanfeili/code/New Projects/novartis_datathon_2025/src/train.py:6071: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  for group_key, group_df in df_val.groupby(available_group_cols):
2025-11-30 10:20:25,342 - src.train - INFO - Saved bias corrections to /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s1/bias_corrections.json
2025-11-30 10:20:25,342 - src.train - INFO - Bias corrections fitted for 241 groups
2025-11-30 10:20:25,344 - src.models.cat_model - INFO - Model saved to /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s1/model_1.bin.cbm with metadata
2025-11-30 10:20:25,344 - src.train - INFO - Model saved to /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s1/model_1.bin
2025-11-30 10:20:25,345 - src.train - INFO - Target transform parameters saved to /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s1/target_transform_params_1.json
2025-11-30 10:20:25,351 - src.train - INFO - Experiment catboost_bonus_all_20251130_101935_s1 completed. Artifacts saved to /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s1
2025-11-30 10:20:25,378 - src.utils - INFO - [Scenario 1 Training] done in 49.710s
2025-11-30 10:20:25,379 - __main__ - INFO - ================================================================================
2025-11-30 10:20:25,379 - __main__ - INFO - ✅ Scenario 1 Training Complete
2025-11-30 10:20:25,379 - __main__ - INFO -    Official Metric: 0.700700
2025-11-30 10:20:25,380 - __main__ - INFO -    RMSE (norm): 0.194279
2025-11-30 10:20:25,380 - __main__ - INFO -    MAE (norm): 0.152342
2025-11-30 10:20:25,381 - __main__ - INFO -    Artifacts: /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s1
2025-11-30 10:20:25,381 - __main__ - INFO - ================================================================================
2025-11-30 10:20:25,381 - __main__ - INFO - 
================================================================================
2025-11-30 10:20:25,382 - __main__ - INFO - [2/3] Training Scenario 2
2025-11-30 10:20:25,382 - __main__ - INFO - ================================================================================
2025-11-30 10:20:25,382 - __main__ - INFO - ================================================================================
2025-11-30 10:20:25,383 - __main__ - INFO - Training Scenario 2
2025-11-30 10:20:25,383 - __main__ - INFO - ================================================================================
2025-11-30 10:20:25,383 - __main__ - INFO - Config: configs/run_bonus_all.yaml
2025-11-30 10:20:25,383 - __main__ - INFO - Run Name: catboost_bonus_all_20251130_101935
2025-11-30 10:20:25,383 - src.utils - INFO - [Scenario 2 Training] starting...
2025-11-30 10:20:25,426 - src.train - INFO - Starting experiment: catboost_bonus_all_20251130_101935_s2
2025-11-30 10:20:25,466 - src.train - INFO - Config snapshot saved to /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s2/configs (hash: bcc22caf)
2025-11-30 10:20:25,467 - src.train - INFO - Config hash: bcc22caf
2025-11-30 10:20:25,488 - src.utils - INFO - [Load features (cached)] starting...
2025-11-30 10:20:25,489 - src.features - INFO - Building features for train S2 train...
2025-11-30 10:20:25,489 - src.data - INFO - Building train panel from raw data...
2025-11-30 10:20:25,490 - src.utils - INFO - [Load train data] starting...
2025-11-30 10:20:25,490 - src.data - INFO - Loading volume from /Users/armanfeili/code/New Projects/novartis_datathon_2025/data/raw/TRAIN/df_volume_train.csv
2025-11-30 10:20:25,580 - src.data - INFO - === train/volume Statistics ===
2025-11-30 10:20:25,581 - src.data - INFO -   Shape: 93,744 rows × 5 columns
2025-11-30 10:20:25,595 - src.data - INFO -   No missing values
2025-11-30 10:20:25,612 - src.data - INFO -   Unique series: 1,953
2025-11-30 10:20:25,612 - src.data - INFO -   months_postgx range: [-24, 23]
2025-11-30 10:20:25,614 - src.data - INFO - Loading generics from /Users/armanfeili/code/New Projects/novartis_datathon_2025/data/raw/TRAIN/df_generics_train.csv
2025-11-30 10:20:25,644 - src.data - INFO - === train/generics Statistics ===
2025-11-30 10:20:25,644 - src.data - INFO -   Shape: 46,872 rows × 4 columns
2025-11-30 10:20:25,651 - src.data - INFO -   Missing values:
2025-11-30 10:20:25,651 - src.data - INFO -     n_gxs: 26.3%
2025-11-30 10:20:25,661 - src.data - INFO -   Unique series: 1,953
2025-11-30 10:20:25,661 - src.data - INFO -   months_postgx range: [0, 23]
2025-11-30 10:20:25,663 - src.data - INFO - Loading medicine_info from /Users/armanfeili/code/New Projects/novartis_datathon_2025/data/raw/TRAIN/df_medicine_info_train.csv
2025-11-30 10:20:25,668 - src.data - INFO - === train/medicine_info Statistics ===
2025-11-30 10:20:25,668 - src.data - INFO -   Shape: 1,953 rows × 7 columns
2025-11-30 10:20:25,671 - src.data - INFO -   Missing values:
2025-11-30 10:20:25,672 - src.data - INFO -     hospital_rate: 3.3%
2025-11-30 10:20:25,673 - src.data - INFO -   Unique series: 1,953
2025-11-30 10:20:25,674 - src.utils - INFO - [Load train data] done in 0.184s
2025-11-30 10:20:25,674 - src.utils - INFO - [Build base panel] starting...
2025-11-30 10:20:25,674 - src.data - INFO - Input shapes: volume=(93744, 5), generics=(46872, 4), medicine_info=(1953, 7)
2025-11-30 10:20:25,726 - src.data - INFO - After volume-generics merge: 93,744 rows
2025-11-30 10:20:25,759 - src.data - INFO - After medicine_info merge: 93,744 rows
2025-11-30 10:20:25,825 - src.data - INFO - === Base Panel Statistics ===
2025-11-30 10:20:25,825 - src.data - INFO -   Shape: 93,744 rows × 11 columns
2025-11-30 10:20:25,849 - src.data - INFO -   Missing values:
2025-11-30 10:20:25,849 - src.data - INFO -     n_gxs: 63.2%
2025-11-30 10:20:25,849 - src.data - INFO -     hospital_rate: 3.3%
2025-11-30 10:20:25,865 - src.data - INFO -   Unique series: 1,953
2025-11-30 10:20:25,865 - src.data - INFO -   months_postgx range: [-24, 23]
2025-11-30 10:20:25,868 - src.utils - INFO - [Build base panel] done in 0.194s
2025-11-30 10:20:25,868 - src.utils - INFO - [Handle missing values] starting...
2025-11-30 10:20:25,889 - src.data - INFO - n_gxs: filled 59208 missing values
2025-11-30 10:20:25,901 - src.data - INFO - hospital_rate: filled with ther_area medians, flag added
2025-11-30 10:20:25,952 - src.data - INFO - No missing values remaining
2025-11-30 10:20:25,952 - src.utils - INFO - [Handle missing values] done in 0.084s
2025-11-30 10:20:25,955 - src.utils - INFO - [Compute pre-entry stats] starting...
2025-11-30 10:20:26,033 - src.data - INFO - avg_vol_12m distribution:
2025-11-30 10:20:26,033 - src.data - INFO -   Range: [37.72, 371038791.09]
2025-11-30 10:20:26,034 - src.data - INFO -   Median: 131382.32
2025-11-30 10:20:26,035 - src.data - INFO -   Mean: 2439028.31
2025-11-30 10:20:26,058 - src.data - INFO - Bucket classification using threshold=0.25
2025-11-30 10:20:26,126 - src.data - INFO - Bucket distribution (train):
2025-11-30 10:20:26,126 - src.data - INFO -   Bucket 1: 130 series (6.7%)
2025-11-30 10:20:26,126 - src.data - INFO -   Bucket 2: 1,823 series (93.3%)
2025-11-30 10:20:26,126 - src.data - INFO - y_norm distribution (train):
2025-11-30 10:20:26,127 - src.data - INFO -   Range: [0.000, 43.792]
2025-11-30 10:20:26,129 - src.data - INFO -   Median: 0.871
2025-11-30 10:20:26,130 - src.data - INFO -   Mean: 0.800
2025-11-30 10:20:26,132 - src.data - WARNING - y_norm.y_norm: 18 values above 5
2025-11-30 10:20:26,132 - src.utils - INFO - [Compute pre-entry stats] done in 0.177s
2025-11-30 10:20:26,151 - src.data - INFO - Panel schema validation passed for train (93,744 rows)
2025-11-30 10:20:26,155 - src.features - INFO - Applying data augmentation to training panel
2025-11-30 10:20:33,394 - src.data - INFO - Augmentation applied: jitter=5.00%, drop_prob=5.00%
2025-11-30 10:20:33,417 - src.utils - INFO - [Feature engineering - Scenario 2] starting...
2025-11-30 10:20:33,560 - src.features - WARNING - No pre-entry data for seasonal features, skipping
2025-11-30 10:20:37,859 - src.features - INFO - Total features created: 94
2025-11-30 10:20:37,860 - src.utils - INFO - [Feature engineering - Scenario 2] done in 4.443s
2025-11-30 10:20:37,932 - src.features - INFO - Selected 33,354 rows for 2 (months 6-23)
2025-11-30 10:20:37,941 - src.features - WARNING - Feature leakage detected: LEAKAGE: Forbidden column present: mean_erosion
2025-11-30 10:20:37,941 - src.features - WARNING - Feature leakage detected: LEAKAGE: Forbidden column present: y_norm
2025-11-30 10:20:37,941 - src.features - WARNING - Feature leakage detected: LEAKAGE: Forbidden column present: brand_name
2025-11-30 10:20:37,941 - src.features - WARNING - Feature leakage detected: LEAKAGE: Forbidden column present: bucket
2025-11-30 10:20:37,941 - src.features - WARNING - Feature leakage detected: LEAKAGE: Forbidden column present: volume
2025-11-30 10:20:37,941 - src.features - WARNING - Feature leakage detected: LEAKAGE: Forbidden column present: country
2025-11-30 10:20:37,969 - src.data - INFO - Data leakage audit passed for scenario 2, mode train
2025-11-30 10:20:37,981 - src.features - INFO - Feature matrix validation passed: X=(33354, 89), y=33354, meta=(33354, 12)
2025-11-30 10:20:37,981 - src.features - INFO - Built features: X=(33354, 89), y=33354, meta=(33354, 12)
2025-11-30 10:20:38,010 - src.utils - INFO - [Load cached train panel] starting...
2025-11-30 10:20:38,010 - src.data - INFO - Loading cached panel from /Users/armanfeili/code/New Projects/novartis_datathon_2025/data/interim/panel_train.parquet
2025-11-30 10:20:38,028 - src.data - INFO - Loaded 93,744 rows, 19 columns
2025-11-30 10:20:38,028 - src.utils - INFO - [Load cached train panel] done in 0.019s
2025-11-30 10:20:38,029 - src.utils - INFO - [Load features (cached)] done in 12.541s
2025-11-30 10:20:38,029 - src.utils - INFO - [Create validation split] starting...
2025-11-30 10:20:38,043 - src.validation - WARNING - Grouping 1 rare stratification classes (< 195 series each, 130 series total) into 'OTHER'
2025-11-30 10:20:38,045 - src.validation - INFO - 'OTHER' class now contains 130 series
2025-11-30 10:20:38,177 - src.validation - INFO - Train series: 1562, Val series: 391
2025-11-30 10:20:38,177 - src.validation - INFO - Train rows: 26,726, Val rows: 6,628
2025-11-30 10:20:38,179 - src.validation - INFO - Train bucket distribution:
bucket
2    0.933419
1    0.066581
2025-11-30 10:20:38,180 - src.validation - INFO - Val bucket distribution:
bucket
2    0.933504
1    0.066496
2025-11-30 10:20:38,201 - src.utils - INFO - [Create validation split] done in 0.173s
2025-11-30 10:20:38,241 - src.train - INFO - Features: 91 columns
2025-11-30 10:20:38,242 - src.train - INFO - Meta: 9 columns: ['country', 'brand_name', 'months_postgx', 'bucket', 'avg_vol_12m', 'y_norm', 'volume', 'mean_erosion', 'month']
2025-11-30 10:20:38,251 - src.train - INFO - Features: 91 columns
2025-11-30 10:20:38,251 - src.train - INFO - Meta: 9 columns: ['country', 'brand_name', 'months_postgx', 'bucket', 'avg_vol_12m', 'y_norm', 'volume', 'mean_erosion', 'month']
2025-11-30 10:20:38,307 - src.train - INFO - Multi-seed experiment enabled
2025-11-30 10:20:38,307 - src.train - INFO - Training with seed 42...
2025-11-30 10:20:38,314 - src.train - INFO - Applied target transform: log1p
2025-11-30 10:20:38,325 - src.train - INFO - Sample weights - min: 0.63, max: 3.13, mean: 1.00
2025-11-30 10:20:38,344 - src.utils - INFO - [Train catboost for scenario 2] starting...
2025-11-30 10:20:38,350 - src.models.cat_model - INFO - Auto-detected 2 categorical features
2025-11-30 10:20:47,763 - src.models.cat_model - INFO - CatBoost trained for 466 iterations
2025-11-30 10:20:47,764 - src.utils - INFO - [Train catboost for scenario 2] done in 9.420s
2025-11-30 10:20:48,673 - src.train - INFO - Validation metrics: Official=0.2646, RMSE=0.1843, MAE=0.1457
2025-11-30 10:20:48,673 - src.train - INFO - Training time: 9.44 seconds
2025-11-30 10:20:48,683 - src.models.cat_model - INFO - Model saved to /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s2/seed_42/model.bin.cbm with metadata
2025-11-30 10:20:48,683 - src.train - INFO - Seed 42: Official=0.2646
2025-11-30 10:20:48,683 - src.train - INFO - Training with seed 2025...
2025-11-30 10:20:48,684 - src.train - INFO - Applied target transform: log1p
2025-11-30 10:20:48,691 - src.train - INFO - Sample weights - min: 0.63, max: 3.13, mean: 1.00
2025-11-30 10:20:48,699 - src.utils - INFO - [Train catboost for scenario 2] starting...
2025-11-30 10:20:48,701 - src.models.cat_model - INFO - Auto-detected 2 categorical features
2025-11-30 10:20:57,292 - src.models.cat_model - INFO - CatBoost trained for 413 iterations
2025-11-30 10:20:57,292 - src.utils - INFO - [Train catboost for scenario 2] done in 8.594s
2025-11-30 10:20:58,292 - src.train - INFO - Validation metrics: Official=0.2737, RMSE=0.1821, MAE=0.1439
2025-11-30 10:20:58,292 - src.train - INFO - Training time: 8.60 seconds
2025-11-30 10:20:58,298 - src.models.cat_model - INFO - Model saved to /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s2/seed_2025/model.bin.cbm with metadata
2025-11-30 10:20:58,298 - src.train - INFO - Seed 2025: Official=0.2737
2025-11-30 10:20:58,298 - src.train - INFO - Training with seed 1337...
2025-11-30 10:20:58,300 - src.train - INFO - Applied target transform: log1p
2025-11-30 10:20:58,307 - src.train - INFO - Sample weights - min: 0.63, max: 3.13, mean: 1.00
2025-11-30 10:20:58,317 - src.utils - INFO - [Train catboost for scenario 2] starting...
2025-11-30 10:20:58,323 - src.models.cat_model - INFO - Auto-detected 2 categorical features
2025-11-30 10:21:05,559 - src.models.cat_model - INFO - CatBoost trained for 370 iterations
2025-11-30 10:21:05,559 - src.utils - INFO - [Train catboost for scenario 2] done in 7.242s
2025-11-30 10:21:06,521 - src.train - INFO - Validation metrics: Official=0.2586, RMSE=0.1820, MAE=0.1437
2025-11-30 10:21:06,521 - src.train - INFO - Training time: 7.25 seconds
2025-11-30 10:21:06,529 - src.models.cat_model - INFO - Model saved to /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s2/seed_1337/model.bin.cbm with metadata
2025-11-30 10:21:06,530 - src.train - INFO - Seed 1337: Official=0.2586
2025-11-30 10:21:06,532 - src.train - INFO - Saved multi-seed summary to /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s2/multi_seed_summary.csv
2025-11-30 10:21:06,532 - src.train - INFO - Multi-seed results:
2025-11-30 10:21:06,532 - src.train - INFO -   Mean official metric: 0.2656
2025-11-30 10:21:06,533 - src.train - INFO -   Std official metric: 0.0076
2025-11-30 10:21:06,533 - src.train - INFO -   Best seed: 1337
2025-11-30 10:21:06,534 - src.train - INFO - Best seed: 1337
2025-11-30 10:21:06,537 - src.train - INFO - Applied target transform: log1p
2025-11-30 10:21:06,548 - src.train - INFO - Sample weights - min: 0.63, max: 3.13, mean: 1.00
2025-11-30 10:21:06,558 - src.utils - INFO - [Train catboost for scenario 2] starting...
2025-11-30 10:21:06,562 - src.models.cat_model - INFO - Auto-detected 2 categorical features
2025-11-30 10:21:14,999 - src.models.cat_model - INFO - CatBoost trained for 466 iterations
2025-11-30 10:21:14,999 - src.utils - INFO - [Train catboost for scenario 2] done in 8.441s
2025-11-30 10:21:15,941 - src.train - INFO - Validation metrics: Official=0.2646, RMSE=0.1843, MAE=0.1457
2025-11-30 10:21:15,941 - src.train - INFO - Training time: 8.45 seconds
2025-11-30 10:21:15,943 - src.train - INFO - Fitting calibration parameters
2025-11-30 10:21:15,983 - src.train - INFO - Saved calibration parameters to /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s2/calibration_params.json
2025-11-30 10:21:15,986 - src.train - INFO - Calibration parameters fitted for 6 groups
2025-11-30 10:21:15,986 - src.train - INFO - Fitting bias corrections
2025-11-30 10:21:16,031 - src.train - INFO - Merged group columns from panel: ['ther_area']
/Users/armanfeili/code/New Projects/novartis_datathon_2025/src/train.py:6071: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  for group_key, group_df in df_val.groupby(available_group_cols):
2025-11-30 10:21:16,076 - src.train - INFO - Saved bias corrections to /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s2/bias_corrections.json
2025-11-30 10:21:16,076 - src.train - INFO - Bias corrections fitted for 241 groups
2025-11-30 10:21:16,079 - src.models.cat_model - INFO - Model saved to /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s2/model_2.bin.cbm with metadata
2025-11-30 10:21:16,079 - src.train - INFO - Model saved to /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s2/model_2.bin
2025-11-30 10:21:16,080 - src.train - INFO - Target transform parameters saved to /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s2/target_transform_params_2.json
2025-11-30 10:21:16,088 - src.train - INFO - Experiment catboost_bonus_all_20251130_101935_s2 completed. Artifacts saved to /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s2
2025-11-30 10:21:16,115 - src.utils - INFO - [Scenario 2 Training] done in 50.732s
2025-11-30 10:21:16,116 - __main__ - INFO - ================================================================================
2025-11-30 10:21:16,116 - __main__ - INFO - ✅ Scenario 2 Training Complete
2025-11-30 10:21:16,116 - __main__ - INFO -    Official Metric: 0.264600
2025-11-30 10:21:16,116 - __main__ - INFO -    RMSE (norm): 0.184331
2025-11-30 10:21:16,116 - __main__ - INFO -    MAE (norm): 0.145730
2025-11-30 10:21:16,117 - __main__ - INFO -    Artifacts: /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s2
2025-11-30 10:21:16,117 - __main__ - INFO - ================================================================================
2025-11-30 10:21:16,117 - __main__ - INFO - 
================================================================================
2025-11-30 10:21:16,117 - __main__ - INFO - [3/3] Generating Submission
2025-11-30 10:21:16,117 - __main__ - INFO - ================================================================================
2025-11-30 10:21:16,117 - __main__ - INFO - ================================================================================
2025-11-30 10:21:16,117 - __main__ - INFO - Generating Submission
2025-11-30 10:21:16,118 - __main__ - INFO - ================================================================================
2025-11-30 10:21:16,129 - src.utils - INFO - [Load cached test panel] starting...
2025-11-30 10:21:16,130 - src.data - INFO - Loading cached panel from /Users/armanfeili/code/New Projects/novartis_datathon_2025/data/interim/panel_test.parquet
2025-11-30 10:21:16,139 - src.data - INFO - Loaded 8,832 rows, 16 columns
2025-11-30 10:21:16,140 - src.utils - INFO - [Load cached test panel] done in 0.010s
2025-11-30 10:21:16,155 - __main__ - INFO - Loaded submission template from: /Users/armanfeili/code/New Projects/novartis_datathon_2025/docs/guide/submission_template.csv
2025-11-30 10:21:16,155 - src.utils - INFO - [Submission Generation] starting...
2025-11-30 10:21:16,155 - src.utils - INFO - [Generate submission] starting...
2025-11-30 10:21:16,176 - src.inference - INFO - Detected 228 Scenario 1 series
2025-11-30 10:21:16,176 - src.inference - INFO - Detected 112 Scenario 2 series
/Users/armanfeili/code/New Projects/novartis_datathon_2025/src/inference.py:326: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  expanded = pd.concat([panel, future_df], ignore_index=True)
2025-11-30 10:21:16,452 - src.inference - INFO - Expanded panel: 5472 -> 10944 rows (added months 0-23)
2025-11-30 10:21:16,454 - src.utils - INFO - [Feature engineering - Scenario 1] starting...
2025-11-30 10:21:17,718 - src.features - INFO - Total features created: 88
2025-11-30 10:21:17,718 - src.utils - INFO - [Feature engineering - Scenario 1] done in 1.264s
2025-11-30 10:21:17,734 - src.inference - WARNING - Bucket 1 model not found at /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s1/bucket1_catboost/model.bin
2025-11-30 10:21:17,734 - src.inference - WARNING - Bucket 2 model not found at /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s1/bucket2_catboost/model.bin
2025-11-30 10:21:17,752 - src.utils - INFO - [Generate submission] done in 1.597s
2025-11-30 10:21:17,753 - src.utils - INFO - [Submission Generation] done in 1.598s
2025-11-30 10:21:17,759 - __main__ - ERROR - ================================================================================
2025-11-30 10:21:17,759 - __main__ - ERROR - ❌ Submission Generation Failed
2025-11-30 10:21:17,759 - __main__ - ERROR -    Error: Invalid type for cat_feature[non-default value idx=0,feature_idx=64]=0.0 : cat_features must be integer or string, real number values and NaN values should be converted to string.
2025-11-30 10:21:17,759 - __main__ - ERROR - ================================================================================
2025-11-30 10:21:17,763 - __main__ - INFO - 
================================================================================
2025-11-30 10:21:17,763 - __main__ - INFO - Training and Submission Pipeline Complete!
2025-11-30 10:21:17,763 - __main__ - INFO - ================================================================================
2025-11-30 10:21:17,763 - __main__ - INFO - 
Results Summary:
2025-11-30 10:21:17,763 - __main__ - INFO -   Scenario 1:
2025-11-30 10:21:17,763 - __main__ - INFO -     Status: success
2025-11-30 10:21:17,764 - __main__ - INFO -     Official Metric: 0.7007
2025-11-30 10:21:17,764 - __main__ - INFO -     Artifacts: /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s1
2025-11-30 10:21:17,764 - __main__ - INFO -   Scenario 2:
2025-11-30 10:21:17,764 - __main__ - INFO -     Status: success
2025-11-30 10:21:17,764 - __main__ - INFO -     Official Metric: 0.2646
2025-11-30 10:21:17,764 - __main__ - INFO -     Artifacts: /Users/armanfeili/code/New Projects/novartis_datathon_2025/artifacts/catboost_bonus_all_20251130_101935_s2
2025-11-30 10:21:17,764 - __main__ - INFO -   Submission:
2025-11-30 10:21:17,764 - __main__ - INFO -     Status: failed
2025-11-30 10:21:17,764 - __main__ - INFO -     File: None
2025-11-30 10:21:17,764 - __main__ - INFO -     Rows: None
2025-11-30 10:21:17,764 - __main__ - INFO - 
Full Results: logs/results_catboost_bonus_all_20251130_101935.json
2025-11-30 10:21:17,764 - __main__ - INFO - Config Summary: logs/config_summary_catboost_bonus_all_20251130_101935.yaml
2025-11-30 10:21:17,764 - __main__ - INFO - Log File: logs/full_pipeline_catboost_bonus_all_20251130_101935.log
2025-11-30 10:21:17,764 - __main__ - INFO - ================================================================================
0:	learn: 0.1899884	test: 0.1877481	best: 0.1877481 (0)	total: 92.4ms	remaining: 4m 37s
100:	learn: 0.1548159	test: 0.1602172	best: 0.1602172 (100)	total: 1.67s	remaining: 48s
200:	learn: 0.1462382	test: 0.1581388	best: 0.1581388 (200)	total: 3.05s	remaining: 42.5s
300:	learn: 0.1399900	test: 0.1574464	best: 0.1572474 (273)	total: 4.34s	remaining: 38.9s
400:	learn: 0.1337294	test: 0.1570901	best: 0.1569837 (379)	total: 5.67s	remaining: 36.7s
500:	learn: 0.1285816	test: 0.1567305	best: 0.1566702 (497)	total: 6.92s	remaining: 34.5s
600:	learn: 0.1238378	test: 0.1566598	best: 0.1564889 (571)	total: 8.32s	remaining: 33.2s
Stopped by overfitting detector  (100 iterations wait)

bestTest = 0.1564888934
bestIteration = 571

Shrink model to first 572 iterations.
0:	learn: 0.1900120	test: 0.1878293	best: 0.1878293 (0)	total: 17.6ms	remaining: 52.9s
100:	learn: 0.1548806	test: 0.1601256	best: 0.1601256 (100)	total: 3.03s	remaining: 1m 26s
200:	learn: 0.1463492	test: 0.1574146	best: 0.1573746 (196)	total: 4.64s	remaining: 1m 4s
300:	learn: 0.1398105	test: 0.1572421	best: 0.1570768 (247)	total: 6.2s	remaining: 55.6s
Stopped by overfitting detector  (100 iterations wait)

bestTest = 0.157076824
bestIteration = 247

Shrink model to first 248 iterations.
0:	learn: 0.1899932	test: 0.1876784	best: 0.1876784 (0)	total: 14.6ms	remaining: 43.7s
100:	learn: 0.1548013	test: 0.1603306	best: 0.1603306 (100)	total: 1.51s	remaining: 43.2s
200:	learn: 0.1466777	test: 0.1577776	best: 0.1577359 (199)	total: 2.9s	remaining: 40.5s
300:	learn: 0.1401010	test: 0.1575721	best: 0.1575416 (299)	total: 4.4s	remaining: 39.5s
400:	learn: 0.1335376	test: 0.1573295	best: 0.1573047 (398)	total: 5.83s	remaining: 37.8s
500:	learn: 0.1279217	test: 0.1568998	best: 0.1568998 (500)	total: 7.25s	remaining: 36.1s
600:	learn: 0.1233479	test: 0.1572651	best: 0.1568959 (501)	total: 8.65s	remaining: 34.5s
Stopped by overfitting detector  (100 iterations wait)

bestTest = 0.1568958964
bestIteration = 501

Shrink model to first 502 iterations.
0:	learn: 0.1899884	test: 0.1877481	best: 0.1877481 (0)	total: 16.8ms	remaining: 50.3s
100:	learn: 0.1548159	test: 0.1602172	best: 0.1602172 (100)	total: 1.54s	remaining: 44.2s
200:	learn: 0.1462382	test: 0.1581388	best: 0.1581388 (200)	total: 3.13s	remaining: 43.6s
300:	learn: 0.1399900	test: 0.1574464	best: 0.1572474 (273)	total: 4.66s	remaining: 41.8s
400:	learn: 0.1337294	test: 0.1570901	best: 0.1569837 (379)	total: 6.08s	remaining: 39.4s
500:	learn: 0.1285816	test: 0.1567305	best: 0.1566702 (497)	total: 7.48s	remaining: 37.3s
600:	learn: 0.1238378	test: 0.1566598	best: 0.1564889 (571)	total: 9.13s	remaining: 36.4s
Stopped by overfitting detector  (100 iterations wait)

bestTest = 0.1564888934
bestIteration = 571

Shrink model to first 572 iterations.
0:	learn: 0.1917744	test: 0.1879012	best: 0.1879012 (0)	total: 19.5ms	remaining: 58.6s
100:	learn: 0.1105776	test: 0.1254027	best: 0.1254027 (100)	total: 1.53s	remaining: 43.8s
200:	learn: 0.1025987	test: 0.1230144	best: 0.1230144 (200)	total: 3.13s	remaining: 43.5s
300:	learn: 0.0975023	test: 0.1224793	best: 0.1224793 (300)	total: 4.58s	remaining: 41.1s
400:	learn: 0.0930319	test: 0.1222217	best: 0.1221506 (385)	total: 6.05s	remaining: 39.2s
500:	learn: 0.0892193	test: 0.1220395	best: 0.1219688 (466)	total: 8.14s	remaining: 40.6s
Stopped by overfitting detector  (100 iterations wait)

bestTest = 0.1219687724
bestIteration = 466

Shrink model to first 467 iterations.
0:	learn: 0.1916964	test: 0.1877876	best: 0.1877876 (0)	total: 20.8ms	remaining: 1m 2s
100:	learn: 0.1108374	test: 0.1247281	best: 0.1247281 (100)	total: 1.47s	remaining: 42.2s
200:	learn: 0.1027364	test: 0.1221944	best: 0.1221944 (200)	total: 3.05s	remaining: 42.5s
300:	learn: 0.0977895	test: 0.1216901	best: 0.1216637 (284)	total: 4.5s	remaining: 40.4s
400:	learn: 0.0932517	test: 0.1215185	best: 0.1214985 (397)	total: 5.92s	remaining: 38.4s
500:	learn: 0.0893354	test: 0.1216104	best: 0.1214848 (413)	total: 8.01s	remaining: 39.9s
Stopped by overfitting detector  (100 iterations wait)

bestTest = 0.1214848376
bestIteration = 413

Shrink model to first 414 iterations.
0:	learn: 0.1916648	test: 0.1878498	best: 0.1878498 (0)	total: 25.8ms	remaining: 1m 17s
100:	learn: 0.1105076	test: 0.1249888	best: 0.1249888 (100)	total: 1.71s	remaining: 49.2s
200:	learn: 0.1026096	test: 0.1227006	best: 0.1227006 (200)	total: 3.06s	remaining: 42.7s
300:	learn: 0.0976688	test: 0.1219136	best: 0.1219136 (300)	total: 4.47s	remaining: 40.1s
400:	learn: 0.0934323	test: 0.1218906	best: 0.1217420 (370)	total: 6s	remaining: 38.9s
Stopped by overfitting detector  (100 iterations wait)

bestTest = 0.1217419861
bestIteration = 370

Shrink model to first 371 iterations.
0:	learn: 0.1917744	test: 0.1879012	best: 0.1879012 (0)	total: 12.5ms	remaining: 37.4s
100:	learn: 0.1105776	test: 0.1254027	best: 0.1254027 (100)	total: 1.37s	remaining: 39.3s
200:	learn: 0.1025987	test: 0.1230144	best: 0.1230144 (200)	total: 2.99s	remaining: 41.7s
300:	learn: 0.0975023	test: 0.1224793	best: 0.1224793 (300)	total: 4.44s	remaining: 39.8s
400:	learn: 0.0930319	test: 0.1222217	best: 0.1221506 (385)	total: 5.89s	remaining: 38.2s
500:	learn: 0.0892193	test: 0.1220395	best: 0.1219688 (466)	total: 7.25s	remaining: 36.2s
Stopped by overfitting detector  (100 iterations wait)

bestTest = 0.1219687724
bestIteration = 466

Shrink model to first 467 iterations.
